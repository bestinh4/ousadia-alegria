<script type="module">
  import { db } from "./firebase.js";
  import {
    collection,
    addDoc,
    getDocs,
    serverTimestamp
  } from "https://www.gstatic.com/firebasejs/10.8.1/firebase-firestore.js";

  const output = document.getElementById("output");

  document.getElementById("btnCriar").onclick = async () => {
    try {
      const docRef = await addDoc(collection(db, "peladas"), {
        nome: "Pelada Teste",
        criadaEm: serverTimestamp()
      });

      output.textContent = "Pelada criada:\n" + docRef.id;
    } catch (err) {
      output.textContent = "Erro ao criar:\n" + err.message;
      console.error(err);
    }
  };

  document.getElementById("btnListar").onclick = async () => {
    try {
      const snapshot = await getDocs(collection(db, "peladas"));
      let texto = "HistÃ³rico:\n\n";

      snapshot.forEach(doc => {
        texto += doc.id + " | " + JSON.stringify(doc.data()) + "\n\n";
      });

      output.textContent = texto || "Nenhuma pelada encontrada";
    } catch (err) {
      output.textContent = "Erro ao listar:\n" + err.message;
      console.error(err);
    }
  };
</script>
